<!DOCTYPE html>
<html>
<head>
	<title>Lb10</title>
	<meta charset="utf-8">


	<script
	  src="https://code.jquery.com/jquery-3.6.0.js"
	  integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
	  crossorigin="anonymous"></script>


	  <style type="text/css">
	  	body{padding: 10px 30px;}table th{background-color: #CCC;}table td, table th{border: 1px solid black;padding: 5px 10px;}ul{margin: 5px;padding-left: 10px;} 
	  </style> 	

</head>
<body>
	<div class="uslovie">
		<h1>Лабораторная робота №10</h1>
		<p>Загрузка данных из XML файла через Javascript. Таблица сформирована так же при помощи JS. Замену чисел на эквивалентные слова осуществлял при помощи замены узлов: ReplaceChild()</p>
	</div>
	<div id="elem"></div>
</body>


<script type="text/javascript">

		var elem = document.querySelector("#elem")
		createTable(elem, 6,7)


		function createTable(parent, cols, rows)
		{
			var table = document.createElement('table')

			var mainRow = document.createElement('tr')
			var mainTd1 = document.createElement('td')

			mainTd1.appendChild(document.createTextNode("Title"))
			mainTd1.setAttribute("class", "mainTd")
			mainRow.appendChild(mainTd1)

			var mainTd2 = document.createElement('td')

			mainTd2.appendChild(document.createTextNode("Stop"))
			mainTd2.setAttribute("class", "mainTd")
			mainRow.appendChild(mainTd2)

			var mainTd3 = document.createElement('td')

			mainTd3.appendChild(document.createTextNode("Shedule"))
			mainTd3.setAttribute("class", "mainTd")
			mainRow.appendChild(mainTd3)

			var mainTd4 = document.createElement('td')

			mainTd4.appendChild(document.createTextNode("Time"))
			mainTd4.setAttribute("class", "mainTd")
			mainRow.appendChild(mainTd4)

			var mainTd5 = document.createElement('td')

			mainTd5.appendChild(document.createTextNode("Price"))
			mainTd5.setAttribute("class", "mainTd")
			mainRow.appendChild(mainTd5)

			var mainTd6 = document.createElement('td')

			mainTd6.appendChild(document.createTextNode("Free"))
			mainTd6.setAttribute("class", "mainTd")
			mainRow.appendChild(mainTd6)


			table.appendChild(mainRow)


			for (var i=0;i<rows;i++)
			{
				var tr = document.createElement('tr')

				for (var j=0;j<cols;j++)
				{
					var td = document.createElement('td')
					tr.appendChild(td)
				}
				table.appendChild(tr)
			}
			parent.appendChild(table)
		}

		var allTd = document.querySelectorAll('td')
		allTd[6].innerHTML ="sdfs"
		console.log(allTd)

		var index = 6;

		fetch('index.xml')
		.then(function(resp){
			return resp.text()
		})
		.then(function(data){
			let parser = new DOMParser(), xmlDoc = parser.parseFromString(data, 'text/xml')
			

			var t200 = document.createTextNode("One hundred");

			var item = xmlDoc.getElementsByTagName('price')[0];
			item.replaceChild(t200, item.childNodes[0])

			var t200 = document.createTextNode("Two hundred");

			var item = xmlDoc.getElementsByTagName('price')[1];
			item.replaceChild(t200, item.childNodes[0])


			var t200 = document.createTextNode("Fifty");

			var item = xmlDoc.getElementsByTagName('price')[2];
			item.replaceChild(t200, item.childNodes[0])

			var t200 = document.createTextNode("One hundred twenty");

			var item = xmlDoc.getElementsByTagName('price')[3];
			item.replaceChild(t200, item.childNodes[0])

			var t200 = document.createTextNode("Twenty");

			var item = xmlDoc.getElementsByTagName('price')[4];
			item.replaceChild(t200, item.childNodes[0])


			var t200 = document.createTextNode("One hundred ten");

			var item = xmlDoc.getElementsByTagName('price')[5];
			item.replaceChild(t200, item.childNodes[0])

			var t200 = document.createTextNode("One hundred thirty");

			var item = xmlDoc.getElementsByTagName('price')[6];
			item.replaceChild(t200, item.childNodes[0])

			for (var i = 0;i<7;i++)
			{
				var title = xmlDoc.getElementsByTagName('title')[i]
				var title1 = title.childNodes[0];
				allTd[index].innerHTML = title1.nodeValue
				index+=1

				var title = xmlDoc.getElementsByTagName('stop')[i]
				var title1 = title.childNodes[0];
				allTd[index].innerHTML = title1.nodeValue
				index+=1

				var title = xmlDoc.getElementsByTagName('shedule')[i]
				var title1 = title.childNodes[0];
				allTd[index].innerHTML = title1.nodeValue
				index+=1

				var title = xmlDoc.getElementsByTagName('time')[i]
				var title1 = title.childNodes[0];
				allTd[index].innerHTML = title1.nodeValue
				index+=1

				var title = xmlDoc.getElementsByTagName('price')[i]
				var title1 = title.childNodes[0];
				allTd[index].innerHTML = title1.nodeValue
				index+=1

				var title = xmlDoc.getElementsByTagName('free')[i]
				var title1 = title.childNodes[0];
				allTd[index].innerHTML = title1.nodeValue
				index+=1
			}



		})
	</script>
</html>